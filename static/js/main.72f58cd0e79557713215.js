webpackJsonp([1],{159:function(e,t){},161:function(e,t){},162:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(163),u=function(e){return e&&e.__esModule?e:{default:e}}(i);t.default=u.default},163:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var u=n(1),o=i(u),a=n(52),l=i(a),r=n(51),s=i(r),d=n(16),c=i(d),h=n(17),m=i(h),f=n(18),p=i(f),v=n(19),g=i(v),y=n(0),C=i(y),I=n(20),_=i(I),E=n(48),k=i(E),x=n(164),T=i(x);n(165);var b=function(e){function t(e){(0,c.default)(this,t);var n=(0,p.default)(this,(t.__proto__||(0,s.default)(t)).call(this,e));return n.state={columns:[]},n}return(0,g.default)(t,e),(0,m.default)(t,[{key:"componentWillMount",value:function(){this.container=null,this.imageIndex=0,this.domColumns=[],this.imageCaches={current:0,pending:!1,end:!1},this.cacheImage(),this.scrollTop=0}},{key:"componentDidMount",value:function(){var e=this.props.getTarget?this.getScrollTarget():window;this.scrollEvent=(0,k.default)(e,"scroll",this.handleScroll.bind(this)),this.resizeEvent=(0,k.default)(e,"resize",this.adaptiveToUpdate.bind(this)),this.adaptiveToUpdate()}},{key:"shouldComponentUpdate",value:function(){var e=this.getColumnNum();return!this.isLoadEnd()&&0!==this.columnNum&&e===this.columnNum}},{key:"componentWillUpdate",value:function(){}},{key:"componentDidUpdate",value:function(){0===this.domColumns.length&&this.initDomColumns(),this.doAppend()}},{key:"componentWillUnmount",value:function(){this.scrollEvent&&this.scrollEvent.remove(),this.resizeEvent&&this.resizeEvent.remove()}},{key:"getScrollTarget",value:function(){var e=this.props.getTarget;return"function"==typeof e?e():window.document.documentElement}},{key:"initDomColumns",value:function(){var e=this,t=this.state.columns;this.props.isOnlyImg&&t.forEach(function(t,n){e.domColumns[n]=[],t.forEach(function(t){var i=e.imageCaches[t.index];i&&e.domColumns[n].push(i)})})}},{key:"getColumnHeight",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=0,n=this.props,i=n.columnWidth;return n.isOnlyImg?e.forEach(function(e){var n=e.width,u=e.height;t+=n/i*u}):t=e.clientHeight,t}},{key:"getShortestIndex",value:function(){var e=void 0,t=void 0,n=void 0;for(var i in this.domColumns)if(e=this.domColumns[i]){var u=this.getColumnHeight(e);0===parseInt(i)&&(t=0,n=u),u<n&&(t=i,n=u)}return t}},{key:"isLoadEnd",value:function(){return this.props.source.length<this.imageIndex}},{key:"shouldAppend",value:function(){var e=this.getShortestIndex(),t=this.domColumns[e];if(this.props.source.length<=this.imageIndex||!t||!this.container)return!1;var n=window.document.documentElement.clientHeight,i=this.getScrollTarget().scrollTop,u=this.getColumnHeight(t);return t&&u<100+i+1.5*n}},{key:"shouldCache",value:function(e){var t=this.imageCaches.current,n=this.props.source,i=!1;return t>n.length?this.imageCaches.end=!0:i=t<=this.imageIndex+e,this.imageCaches.pending=i,i}},{key:"cacheImage",value:function(){var e=this,t=this.props,n=t.source,i=t.isOnlyImg,u=3*this.columnNum||10;if(this.shouldCache(u)){var o=this.imageCaches.current++;if(this.imageCaches[o])this.shouldCache(u)&&this.cacheImage();else{var a=n[o],l=new Image;l.onload=function(){e.imageCaches[o]=l,o<e.columnNum&&i&&(e.domColumns[o]=[l]),clearInterval(void 0),e.shouldCache(u)&&e.cacheImage()},l.src=a}}}},{key:"doAppend",value:function(){var e=this,t=this.imageIndex,n=this.imageCaches[t];if(!n||0===this.domColumns.length)return this.imageCaches.pending||this.cacheImage(),void setTimeout(function(){e.doAppend()},100);if(this.shouldAppend()){var i=this.getShortestIndex(),u=this.state.columns,o=this.props,a=o.source;o.isOnlyImg&&this.domColumns[i].push(n);var l=u[i];l.push({img:a[t],index:t}),u[i]=l,this.imageIndex++,this.setState({columns:u})}}},{key:"getColumnNum",value:function(){var e=this.props.columnWidth,t=this.container.clientWidth;return Math.floor((t-20)/(e+20))}},{key:"adaptiveToUpdate",value:function(){if(this.container){var e=this.getColumnNum();if(e!==this.columnNum){var t=this.props.source;this.domColumns=[],this.columnNum=e,this.imageIndex=0;for(var n=[],i=0;i<this.columnNum;i++)n.push([{img:t[i],index:this.imageIndex++}]);this.setState({columns:n})}}}},{key:"handleScroll",value:function(){var e=this.getScrollTarget().scrollTop;!this.isLoadEnd()&&Math.abs(e-this.scrollTop)>100&&(this.scrollTop=e,this.cacheImage(),this.doAppend())}},{key:"render",value:function(){var e=this,t=this.props,n=t.columnWidth,i=t.isOnlyImg,u=t.renderItem,a=void 0===u?function(e,t){return C.default.createElement("img",{src:t})}:u,r=this.state.columns;return C.default.createElement("div",{className:"waterfall-container",ref:function(t){e.container=t}},r.map(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],u=arguments[1];return C.default.createElement("div",{key:u,ref:function(t){i||(e.domColumns[u]=t)}},t.map(function(e,t){return C.default.createElement(T.default,(0,o.default)({key:e.index},(0,l.default)({},e,{cIndex:t,renderItem:a,columnWidth:n})))}))}))}}]),t}(C.default.Component);b.defaultProps={source:[],columnWidth:210,isOnlyImg:!1},b.propTypes={source:_.default.array,columnWidth:_.default.number,renderItem:_.default.func,getTarget:_.default.func,isOnlyImg:_.default.bool},t.default=b},164:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var u=n(51),o=i(u),a=n(16),l=i(a),r=n(17),s=i(r),d=n(18),c=i(d),h=n(19),m=i(h),f=n(0),p=i(f),v=n(20),g=i(v),y=function(e){function t(e){(0,l.default)(this,t);var n=(0,c.default)(this,(t.__proto__||(0,o.default)(t)).call(this,e));return n.state={},n}return(0,m.default)(t,e),(0,s.default)(t,[{key:"shouldComponentUpdate",value:function(e){return this.props.index!==e.index}},{key:"render",value:function(){var e=this.props,t=e.index,n=void 0===t?0:t,i=e.cIndex,u=void 0===i?0:i,o=e.img,a=void 0===o?"":o,l=e.renderItem,r=e.columnWidth;return p.default.createElement("div",{style:{display:"block",width:r}},l(u,n,a))}}]),t}(p.default.Component);y.propTypes={index:g.default.number,cIndex:g.default.number,img:g.default.string,renderItem:g.default.func,columnWidth:g.default.number},t.default=y},165:function(e,t){},70:function(e,t){},71:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var u=n(0),o=i(u),a=n(33),l=i(a),r=n(82),s=i(r);l.default.render(o.default.createElement(s.default,null),document.getElementById("root"))},82:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var u=n(83),o=i(u),a=n(51),l=i(a),r=n(16),s=i(r),d=n(17),c=i(d),h=n(18),m=i(h),f=n(19),p=i(f);n(157);var v=n(0),g=i(v),y=n(162),C=i(y),I=function(e){function t(){return(0,s.default)(this,t),(0,m.default)(this,(t.__proto__||(0,l.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,c.default)(t,[{key:"render",value:function(){for(var e=[],t=0;t<320;t++){var n=parseInt(t<163?t:t-162);n<10?n="00"+n:n<100&&(n="0"+n),e.push("http://cued.xunlei.com/demos/publ/img/P_"+n+".jpg")}var i=function(e,t,n){var i=t+1,u=i<10?"00"+i:i<100?"0"+i:i;return g.default.createElement(o.default,{key:u,hoverable:!0,style:{margin:"10px"},cover:g.default.createElement("img",{alt:u,src:n})},g.default.createElement(o.default.Meta,{title:u,description:n}))},u={source:e,renderItem:i};return g.default.createElement("div",{style:{textAlign:"center",padding:"20px"}},g.default.createElement("h1",null,"Demo of rc-waterfall"),g.default.createElement(C.default,u),g.default.createElement("h1",null,"The End"))}}]),t}(g.default.Component);t.default=I}},[71]);